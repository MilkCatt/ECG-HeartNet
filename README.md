# ECG-HeartNet

## Installing Dependencies
Install your preferred variant of Pytorch 2.6 for your system, then install the rest of the requirements in `requirements.txt`.

## Data
Get the cleaned and balanced dataset from [here](https://seafile.purplecircle.xyz/f/573a30fb84274704a9c9/?dl=1), then unzip it to the project folder.

The folder structure should be arranged like this:

```
.
├── data                            
│   ├── ecg_clipped                 # Folder contains each sample 
│   │   ├── 00001.csv               # as separate CSVs
│   │   ├── ...
│   │   └── 45551.csv
│   └── diagnoses_balanced.csv      # Contains labels
│   ...
├── run.ipynb                       # Main notebook with training code
├── models.py                       # Contains models in PyTorch modules
├── dataset.py                      # Contains dataset objects
└── utils.py                        # Misc. utility functions

```

Additional folders are:
* training_progress - Contains checkpoints and histories across the different iterations of our models.
* archive - Contains old code testing files and previous iterations
* metadata - Contains the mean and standard deviation of each of the 12-leads, used for pre-processing.
* scripts - This folder contains all the scripts used for data preprocessing, cleaning, and visualisation.

## Running the model
The model can be run by running `run.ipynb`. The appropriate cells are annotated. 

### How to retrain model 

Before retraining the model, it is important to note that we have also included a “Settings” code block which allows you to configure model hyperparameters, data paths, and save paths.  

### From scratch 

Once setup, you can simply run the run.ipynb file from the start until the “Start from 0” markdown block. Running the code below that block with create an instance of the model and the trainer, then invoke the train method. 

The trainer class is configured to save every `checkpoint_interval`, into the `model_progress` folder. 

### From our saved weights 

Similar to training the model from scratch, run the run.ipynb file from start until the “Start from 0” markdown block. Do not run the code block below that. Instead, run the code block below the “Resume from a Checkpoint” markdown. This runs the model from the weights saved in `training_progress/clipped_balanced3/ checkpoint_ep7_b4773.pt`. These is also the set of model weights we are using to evaluate the model in this report. 

Should you wish to view the loss graphs, F1 scores, and confusion matrices generated by our model training, you can simply run the `run.ipynb` notebook up to the model training blocks, skip the 2 model training blocks mentioned above, then continue to run the remaining code blocks within the notebook. 